function get_pkg_ver() {
  local github_repos=tvheadend/tvheadend

  local upstream_default_branch=$(curl -m 5 -sL "https://api.github.com/repos/${github_repos}" | jq -r '.default_branch')
  local upstream_latest_commit=$(curl -m 5 -sL "https://api.github.com/repos/${github_repos}/git/refs/heads/${upstream_default_branch}" | jq -r '.object.url')

  pkgver=$(echo ${upstream_latest_commit} | sed 's#.*/##')
}

function update_package() {
  [ -d tvheadend.git ] || git clone https://github.com/tvheadend/tvheadend.git tvheadend.git
  pushd .
  cd tvheadend.git
    git checkout master
    git fetch
    git pull --rebase
    git checkout ${fullhash}
    TVH_VER=$(support/version)
    git checkout master
    tvhver=${TVH_VER/\~[a-z0-9]*/}
  popd
  sed -e "s|^PKG_VERSION_NUMBER=.*|PKG_VERSION_NUMBER=\"${tvhver}\"|" -i "${pkgmk}"
  sed -e "s|^PKG_VERSION=.*|PKG_VERSION=\"${pkgver}\"|" -i "${pkgmk}"
  CHANGE_HASH=yes scripts/get ${pkgname}
}
